<!DOCTYPE html>
<html lang="en" dir="auto">

<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>penalties and rewards for fair learning in paired kidney exchange programs | ariana&#39;s blog</title>
<meta name="keywords" content="paper">
<meta name="description" content="Following yesterday, the second paper I&rsquo;d recommend is Carvalho et al. Penalties and Rewards for Fair Learning in Paired Kidney Exchange Programs (WINE2023).
The paper took a data-driven approach and tested its method on Canadian Kidney Exchange program&rsquo;s data. It established a dynamic (over time) kidney exchange model so as to take in consideration of some aspects missed by myopic naive matching schemes. They developed a novel learning approach to update the weights of the vertices so as to improve equity as well as efficiency.">
<meta name="author" content="">
<link rel="canonical" href="//localhost:1313/posts/optimizing_kidney_exchanges1/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.5cfc680b1eeaeef9efbced92d46c2a9e876b72ee14fba85846afc4cff9e6e6f8.css" integrity="sha256-XPxoCx7q7vnvvO2S1Gwqnodrcu4U&#43;6hYRq/Ez/nm5vg=" rel="preload stylesheet" as="style">
<script defer crossorigin="anonymous" src="/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js" integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG&#43;9vmJ0cTS&#43;ovo0FeA="
    onload="hljs.initHighlightingOnLoad();"></script>
<link rel="icon" href="//localhost:1313/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="//localhost:1313/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="//localhost:1313/favicon-32x32.png">
<link rel="apple-touch-icon" href="//localhost:1313/apple-touch-icon.png">
<link rel="mask-icon" href="//localhost:1313/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="//localhost:1313/posts/optimizing_kidney_exchanges1/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --hljs-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/katex.min.css" integrity="sha384-GvrOXuhMATgEsSwCs4smul74iXGOixntILdUW9XmUC6+HX0sLNAK3q71HotJqlAn" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/katex.min.js" integrity="sha384-cpW21h6RZv/phavutF+AuVYrr+dA8xD9zs6FwLpaCct6O9ctzYFfFr4dgmgccOTx" crossorigin="anonymous"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/contrib/auto-render.min.js" integrity="sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05" crossorigin="anonymous"
    onload="renderMathInElement(document.body);"></script>
<script>
    document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement(document.body, {
          
          
          delimiters: [
              {left: '$$', right: '$$', display: true},
              {left: '$', right: '$', display: false},
              {left: '\\(', right: '\\)', display: false},
              {left: '\\[', right: '\\]', display: true}
          ],
          
          throwOnError : false
        });
    });
</script>




<meta property="og:title" content="penalties and rewards for fair learning in paired kidney exchange programs" />
<meta property="og:description" content="Following yesterday, the second paper I&rsquo;d recommend is Carvalho et al. Penalties and Rewards for Fair Learning in Paired Kidney Exchange Programs (WINE2023).
The paper took a data-driven approach and tested its method on Canadian Kidney Exchange program&rsquo;s data. It established a dynamic (over time) kidney exchange model so as to take in consideration of some aspects missed by myopic naive matching schemes. They developed a novel learning approach to update the weights of the vertices so as to improve equity as well as efficiency." />
<meta property="og:type" content="article" />
<meta property="og:url" content="//localhost:1313/posts/optimizing_kidney_exchanges1/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-03-31T17:16:17+08:00" />
<meta property="article:modified_time" content="2024-03-31T17:16:17+08:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="penalties and rewards for fair learning in paired kidney exchange programs"/>
<meta name="twitter:description" content="Following yesterday, the second paper I&rsquo;d recommend is Carvalho et al. Penalties and Rewards for Fair Learning in Paired Kidney Exchange Programs (WINE2023).
The paper took a data-driven approach and tested its method on Canadian Kidney Exchange program&rsquo;s data. It established a dynamic (over time) kidney exchange model so as to take in consideration of some aspects missed by myopic naive matching schemes. They developed a novel learning approach to update the weights of the vertices so as to improve equity as well as efficiency."/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "//localhost:1313/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "penalties and rewards for fair learning in paired kidney exchange programs",
      "item": "//localhost:1313/posts/optimizing_kidney_exchanges1/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "penalties and rewards for fair learning in paired kidney exchange programs",
  "name": "penalties and rewards for fair learning in paired kidney exchange programs",
  "description": "Following yesterday, the second paper I\u0026rsquo;d recommend is Carvalho et al. Penalties and Rewards for Fair Learning in Paired Kidney Exchange Programs (WINE2023).\nThe paper took a data-driven approach and tested its method on Canadian Kidney Exchange program\u0026rsquo;s data. It established a dynamic (over time) kidney exchange model so as to take in consideration of some aspects missed by myopic naive matching schemes. They developed a novel learning approach to update the weights of the vertices so as to improve equity as well as efficiency.\n",
  "keywords": [
    "paper"
  ],
  "articleBody": "Following yesterday, the second paper I’d recommend is Carvalho et al. Penalties and Rewards for Fair Learning in Paired Kidney Exchange Programs (WINE2023).\nThe paper took a data-driven approach and tested its method on Canadian Kidney Exchange program’s data. It established a dynamic (over time) kidney exchange model so as to take in consideration of some aspects missed by myopic naive matching schemes. They developed a novel learning approach to update the weights of the vertices so as to improve equity as well as efficiency.\nABSTRACT A kidney exchange program, also called a kidney paired donation program, can be viewed as a repeated, dynamic trading and allocation mechanism. This suggests that a dynamic algorithm for transplant exchange selection may have superior performance in comparison to the repeated use of a static algorithm. We confirm this hypothesis using a full scale simulation of the Canadian Kidney Paired Donation Program: learning algorithms, that attempt to learn optimal patient-donor weights in advance via dynamic simulations, do lead to improved outcomes. Specifically, our learning algorithms, designed with the objective of fairness (that is, equity in terms of transplant accessibility across cPRA groups), also lead to an increased number of transplants and shorter average waiting times. Indeed, our highest performing learning algorithm improves egalitarian fairness by 10% whilst also increasing the number of transplants by 6% and decreasing waiting times by 24%. However, our main result is much more surprising. We find that the most critical factor in determining the performance of a kidney exchange program is not the judicious assignment of positive weights (rewards) to patient-donor pairs. Rather, the key factor in increasing the number of transplants, decreasing waiting times and improving group fairness is the judicious assignment of a negative weight (penalty) to the small number of non-directed donors in the kidney exchange program.\na quick overview of the paper’s model The paper is concisely written. Here’s a brief write-up but I would strongly recommend referring to the original paper: https://doi.org/10.1007/978-3-031-48974-7_8\nIt is convenient to think the existing kidney exchange market as a compatibility graph that change over time – with patient-donor pairs arriving and leaving. The graph, of course, is dynamic: arrival is assumed as Poisson process, with arrival rates, as well as blood type and cPRA distributions estimated from real data. Match compatibility is drawn randomly from distribution given by cPRA.\nTraditionally, exchange programs have a human-expert designed, a rather static scoring system for assigning weights to patients wrt wait time, match hardness, etc.. This paper took a dynamic learning approach that assign weights to each types (denoted as subscript $\\tau$) and optimizes matching accordingly. Initally, for all types, initial weight is assigned as $w^0_\\tau = 1$, and is updated accordingly to $$ w^{t +1 }\\tau = f\\left(\\frac{\\text{que}r (\\mathbf w^t)}{\\text{pop}\\tau}\\right) $$ where $f$ is a monotonically increasing update function, set to be either (i) linear: $f(x) = 1 + \\frac xa$ or (ii) exponential: $f(x) = (a + 1) - ae^x$ ($a$ is a picked parameter​). $\\text{pop}\\tau$/$\\text{que}_\\tau$ is defined as the proportion of type $\\tau$ in the population/waiting pool.\nconclusion One of the most critical insights from this research is the importance of assigning a negative weight to non-directed donors. This strategy has been shown to be a key factor in increasing the number of transplants, reducing waiting times, and enhancing fairness in the allocation process.\nThe paper outlines six key lessons that can be drawn from their findings:\nNegligible Benefit in Long Paths: Extending the length of paths beyond five does not significantly increase the number of matches, suggesting that a cap of five is sufficient for optimal performance. Importance of Cycle Length: Allowing for cycles of length three is crucial, while the benefits of longer cycles are marginal. Critical Role of Altruist Weights: Assigning an appropriate negative weight to altruistic donors is fundamental in determining the quality of outcomes, highlighting the need for a careful balance between utilizing and preserving this valuable resource. Marginal Contribution of Altruistic Donors: The contribution of each additional altruistic donor decreases as their number increases, emphasizing the importance of optimizing their use. Reduction in Hard-to-Match Patients: Fair algorithms can effectively reduce the accumulation of hard-to-match patients in waiting pools, addressing a significant challenge in kidney exchange programs. Compatibility of Fairness and Efficiency: Fair algorithms can be implemented without detrimental effects on utilitarian measures such as waiting times and the number of transplants, demonstrating that fairness and efficiency can coexist. These lessons provide valuable insights for the design and improvement of kidney exchange programs, not only in Canada but also globally. By integrating these findings into their operations, these programs can save more lives while ensuring a fairer distribution of transplants across different patient groups.\nIn summary, the study adopted a dynamic and data-driven approach, the authors have developed a learning algorithm that continuously updates the weights of patient-donor pairs, leading to improved outcomes in terms of both efficiency and equity.\nreference Carvalho, M., Caulfield, A., Lin, Y., Vetta, A. (2024). Penalties and Rewards for Fair Learning in Paired Kidney Exchange Programs. In: Garg, J., Klimm, M., Kong, Y. (eds) Web and Internet Economics. WINE 2023. Lecture Notes in Computer Science, vol 14413. Springer, Cham. https://doi.org/10.1007/978-3-031-48974-7_8\n",
  "wordCount" : "861",
  "inLanguage": "en",
  "datePublished": "2024-03-31T17:16:17+08:00",
  "dateModified": "2024-03-31T17:16:17+08:00",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "//localhost:1313/posts/optimizing_kidney_exchanges1/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "ariana's blog",
    "logo": {
      "@type": "ImageObject",
      "url": "//localhost:1313/favicon.ico"
    }
  }
}
</script>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Product+Sans:wght@400;700&display=swap" rel="stylesheet">
    
    <link rel="stylesheet" href="//localhost:1313/css/custom.b017fc6c61ff4eacd2943e3c9726e1a935c706d1ea1a1b7c17773e63b47342d3.css">
    
<script async src="https://www.googletagmanager.com/gtag/js?id=AW-16651897053">
</script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'AW-16651897053');
</script>

<script>
  gtag('event', 'conversion', {
      'send_to': 'AW-16651897053/wjItCK3FisUZEN2Rn4Q-',
      'value': 1.0,
      'currency': 'USD'
  });
</script>


<script async src="https://www.googletagmanager.com/gtag/js?id=AW-16651897053"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'AW-16651897053');
</script>

</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="//localhost:1313/" accesskey="h" title="ariana&#39;s blog (Alt + H)">ariana&#39;s blog</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
                <ul class="lang-switch"><li>|</li>
                </ul>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="//localhost:1313/search" title="search (Alt &#43; /)" accesskey=/>
                    <span>search</span>
                </a>
            </li>
            <li>
                <a href="//localhost:1313/archives" title="archive">
                    <span>archive</span>
                </a>
            </li>
            <li>
                <a href="//localhost:1313/posts/tags" title="tags">
                    <span>tags</span>
                </a>
            </li>
            <li>
                <a href="//localhost:1313/posts/pinned" title="about me">
                    <span>about me</span>
                </a>
            </li>
            <li>
                <a href="//localhost:1313/procrastination_bulletin" title="pending ideas">
                    <span>pending ideas</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    
    <h1 class="post-title">
      penalties and rewards for fair learning in paired kidney exchange programs
    </h1>
    <div class="post-meta">&lt;span title=&#39;2024-03-31 17:16:17 &#43;0800 &#43;0800&#39;&gt;March 31, 2024&lt;/span&gt;

</div>
  </header>
  <div class="post-content"><p>Following <a href="/posts/optimizing_kidney_exchanges">yesterday</a>, the second paper I&rsquo;d recommend is Carvalho et al. <em>Penalties and Rewards for Fair Learning in Paired Kidney Exchange Programs</em> (WINE2023).</p>
<p>The paper took a data-driven approach and tested its method on Canadian Kidney Exchange program&rsquo;s data. It established a dynamic (over time) kidney exchange model so as to take in consideration of some aspects missed by myopic naive matching schemes. They developed a novel <strong>learning</strong> approach to update the <strong>weights</strong> of the vertices so as to improve equity as well as efficiency.</p>
<blockquote>
<h3 id="abstract"><em>ABSTRACT</em><a hidden class="anchor" aria-hidden="true" href="#abstract">#</a></h3>
<p>A kidney exchange program, also called a kidney paired donation program, can be viewed as a repeated, dynamic trading and allocation mechanism. This suggests that a dynamic algorithm for transplant exchange selection may have superior performance in comparison to the repeated use of a static algorithm. We confirm this hypothesis using a full scale simulation of the Canadian Kidney Paired Donation Program: learning algorithms, that attempt to learn optimal patient-donor weights in advance via dynamic simulations, do lead to improved outcomes. Specifically, our learning algorithms, designed with the objective of fairness (that is, equity in terms of transplant accessibility across cPRA groups), also lead to an increased number of transplants and shorter average waiting times. Indeed, our highest performing learning algorithm improves egalitarian fairness by 10% whilst also increasing the number of transplants by 6% and decreasing waiting times by 24%. However, our main result is much more surprising. We find that the most critical factor in determining the performance of a kidney exchange program is not the judicious assignment of positive weights (rewards) to patient-donor pairs. Rather, the key factor in increasing the number of transplants, decreasing waiting times and improving group fairness is the judicious assignment of a negative weight (penalty) to the small number of non-directed donors in the kidney exchange program.</p>
</blockquote>
<h3 id="a-quick-overview-of-the-papers-model">a quick overview of the paper&rsquo;s model<a hidden class="anchor" aria-hidden="true" href="#a-quick-overview-of-the-papers-model">#</a></h3>
<blockquote>
<p>The paper is concisely written. Here&rsquo;s a brief write-up but I would strongly recommend referring to the original paper: <a href="https://doi.org/10.1007/978-3-031-48974-7_8">https://doi.org/10.1007/978-3-031-48974-7_8</a></p>
</blockquote>
<p>It is convenient to think the existing kidney exchange market as a <strong>compatibility graph</strong> that change over time – with patient-donor pairs arriving and leaving. The graph, of course, is <strong>dynamic</strong>: arrival is assumed as Poisson process, with arrival rates, as well as blood type and cPRA distributions estimated from real data. Match compatibility is drawn randomly from distribution given by cPRA.</p>
<p>Traditionally, exchange programs have a human-expert designed, a rather static scoring system for assigning weights to patients wrt wait time, match hardness, etc.. This paper took a dynamic learning approach that assign weights to each types (denoted as subscript $\tau$) and optimizes matching accordingly. Initally, for all types, initial weight is assigned as $w^0_\tau = 1$, and is updated accordingly to
$$
w^{t +1 }<em>\tau = f\left(\frac{\text{que}<em>r (\mathbf w^t)}{\text{pop}</em>\tau}\right)
$$
where $f$ is a monotonically increasing update function, set to be either (i) linear: $f(x) = 1 + \frac xa$ or (ii) exponential: $f(x) = (a + 1) - ae^x$ ($a$ is a picked parameter​). $\text{pop}</em>\tau$/$\text{que}_\tau$ is defined as the proportion of type $\tau$ in the population/waiting pool.</p>
<h3 id="conclusion">conclusion<a hidden class="anchor" aria-hidden="true" href="#conclusion">#</a></h3>
<p>One of the most critical insights from this research is the importance of assigning a negative weight to non-directed donors. This strategy has been shown to be a key factor in increasing the number of transplants, reducing waiting times, and enhancing fairness in the allocation process.</p>
<p>The paper outlines six key lessons that can be drawn from their findings:</p>
<ol>
<li><strong>Negligible Benefit in Long Paths:</strong> Extending the length of paths beyond five does not significantly increase the number of matches, suggesting that a cap of five is sufficient for optimal performance.</li>
<li><strong>Importance of Cycle Length:</strong> Allowing for cycles of length three is crucial, while the benefits of longer cycles are marginal.</li>
<li><strong>Critical Role of Altruist Weights:</strong> Assigning an appropriate negative weight to altruistic donors is fundamental in determining the quality of outcomes, highlighting the need for a careful balance between utilizing and preserving this valuable resource.</li>
<li><strong>Marginal Contribution of Altruistic Donors:</strong> The contribution of each additional altruistic donor decreases as their number increases, emphasizing the importance of optimizing their use.</li>
<li><strong>Reduction in Hard-to-Match Patients:</strong> Fair algorithms can effectively reduce the accumulation of hard-to-match patients in waiting pools, addressing a significant challenge in kidney exchange programs.</li>
<li><strong>Compatibility of Fairness and Efficiency:</strong> Fair algorithms can be implemented without detrimental effects on utilitarian measures such as waiting times and the number of transplants, demonstrating that fairness and efficiency can coexist.</li>
</ol>
<p>These lessons provide valuable insights for the design and improvement of kidney exchange programs, not only in Canada but also globally. By integrating these findings into their operations, these programs can save more lives while ensuring a fairer distribution of transplants across different patient groups.</p>
<p>In summary, the study adopted a dynamic and data-driven approach, the authors have developed a learning algorithm that continuously updates the weights of patient-donor pairs, leading to improved outcomes in terms of both efficiency and equity.</p>
<h3 id="reference">reference<a hidden class="anchor" aria-hidden="true" href="#reference">#</a></h3>
<p>Carvalho, M., Caulfield, A., Lin, Y., Vetta, A. (2024). Penalties and Rewards for Fair Learning in Paired Kidney Exchange Programs. In: Garg, J., Klimm, M., Kong, Y. (eds) Web and Internet Economics. WINE 2023. Lecture Notes in Computer Science, vol 14413. Springer, Cham. <a href="https://doi.org/10.1007/978-3-031-48974-7_8">https://doi.org/10.1007/978-3-031-48974-7_8</a></p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="//localhost:1313/tags/paper/">Paper</a></li>
    </ul>
  </footer>
</article>
    </main>
    
<footer class="footer">
    <span>&copy; 2025 <a href="//localhost:1313/">ariana&#39;s blog</a></span>
    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script id="usercentrics-cmp" src="https://web.cmp.usercentrics.eu/ui/loader.js" data-settings-id="_KlbvhaKistzRA" async></script>

</body>

</html>
