<!DOCTYPE html>
<html lang="en" dir="auto">

<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Whittle index | an example | ariana&#39;s blog</title>
<meta name="keywords" content="">
<meta name="description" content="Consider the following RMAB problem instance. (For a review of what is an RMAB, check out here). A platform coordinates a total of $N$ volunteers for various tasks.
At each time point, a task $k$ out of $K$ possible tasks arrives randomly with probability $f_k$, and the platform must decide whom to notify (activate) based on the likelihood of acceptance $p_{k, i}, i\in [N]$ and the potential reward for each volunteer incentivized, exogeneously given as $w_k$.">
<meta name="author" content="">
<link rel="canonical" href="//localhost:1313/posts/whittle_index_technical_1/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.5cfc680b1eeaeef9efbced92d46c2a9e876b72ee14fba85846afc4cff9e6e6f8.css" integrity="sha256-XPxoCx7q7vnvvO2S1Gwqnodrcu4U&#43;6hYRq/Ez/nm5vg=" rel="preload stylesheet" as="style">
<script defer crossorigin="anonymous" src="/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js" integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG&#43;9vmJ0cTS&#43;ovo0FeA="
    onload="hljs.initHighlightingOnLoad();"></script>
<link rel="icon" href="//localhost:1313/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="//localhost:1313/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="//localhost:1313/favicon-32x32.png">
<link rel="apple-touch-icon" href="//localhost:1313/apple-touch-icon.png">
<link rel="mask-icon" href="//localhost:1313/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="//localhost:1313/posts/whittle_index_technical_1/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --hljs-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/katex.min.css" integrity="sha384-GvrOXuhMATgEsSwCs4smul74iXGOixntILdUW9XmUC6+HX0sLNAK3q71HotJqlAn" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/katex.min.js" integrity="sha384-cpW21h6RZv/phavutF+AuVYrr+dA8xD9zs6FwLpaCct6O9ctzYFfFr4dgmgccOTx" crossorigin="anonymous"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/contrib/auto-render.min.js" integrity="sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05" crossorigin="anonymous"
    onload="renderMathInElement(document.body);"></script>
<script>
    document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement(document.body, {
          
          
          delimiters: [
              {left: '$$', right: '$$', display: true},
              {left: '$', right: '$', display: false},
              {left: '\\(', right: '\\)', display: false},
              {left: '\\[', right: '\\]', display: true}
          ],
          
          throwOnError : false
        });
    });
</script>




<meta property="og:title" content="Whittle index | an example" />
<meta property="og:description" content="Consider the following RMAB problem instance. (For a review of what is an RMAB, check out here). A platform coordinates a total of $N$ volunteers for various tasks.
At each time point, a task $k$ out of $K$ possible tasks arrives randomly with probability $f_k$, and the platform must decide whom to notify (activate) based on the likelihood of acceptance $p_{k, i}, i\in [N]$ and the potential reward for each volunteer incentivized, exogeneously given as $w_k$." />
<meta property="og:type" content="article" />
<meta property="og:url" content="//localhost:1313/posts/whittle_index_technical_1/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-06-07T12:29:06+08:00" />
<meta property="article:modified_time" content="2024-06-07T12:29:06+08:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Whittle index | an example"/>
<meta name="twitter:description" content="Consider the following RMAB problem instance. (For a review of what is an RMAB, check out here). A platform coordinates a total of $N$ volunteers for various tasks.
At each time point, a task $k$ out of $K$ possible tasks arrives randomly with probability $f_k$, and the platform must decide whom to notify (activate) based on the likelihood of acceptance $p_{k, i}, i\in [N]$ and the potential reward for each volunteer incentivized, exogeneously given as $w_k$."/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "//localhost:1313/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "Whittle index | an example",
      "item": "//localhost:1313/posts/whittle_index_technical_1/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Whittle index | an example",
  "name": "Whittle index | an example",
  "description": "Consider the following RMAB problem instance. (For a review of what is an RMAB, check out here). A platform coordinates a total of $N$ volunteers for various tasks.\nAt each time point, a task $k$ out of $K$ possible tasks arrives randomly with probability $f_k$, and the platform must decide whom to notify (activate) based on the likelihood of acceptance $p_{k, i}, i\\in [N]$ and the potential reward for each volunteer incentivized, exogeneously given as $w_k$.\n",
  "keywords": [
    
  ],
  "articleBody": "Consider the following RMAB problem instance. (For a review of what is an RMAB, check out here). A platform coordinates a total of $N$ volunteers for various tasks.\nAt each time point, a task $k$ out of $K$ possible tasks arrives randomly with probability $f_k$, and the platform must decide whom to notify (activate) based on the likelihood of acceptance $p_{k, i}, i\\in [N]$ and the potential reward for each volunteer incentivized, exogeneously given as $w_k$.\nEach volunteer can either be active or inactive at a certain time point. Only active volunteers can generate reward when incentivized (aka there’s no use in incentivizing an inactive volunteer). Once an active volunteer produces, she instantly becomes inactive and recovers to activity based on specific probabilities $q_i$. As shown in the following diagram:\nthe state transitions of volunteers based on actions and associated probabilities. Active volunteers ($s_t = 1$), when no action is taken ($y_t = 0$) remains active. If action is taken ($y_t = 1$), they might generate a reward w.p. $p_i$ and become inactive, or stay active without generating a reward. Inactive volunteer return to activity based on specific probabilities ($q_i$).\nThe decision maker (in the perspective of the platform) has action space $\\mathbf y^t$, where each $y_i^t\\in {0, 1}, \\forall i$ corresponds to whether arm $i$ is being ‘pulled’ at time step $t$. The platform aims to maximizes averaged reward over the long run: $$ \\max_\\pi \\lim_{T\\to\\infty}\\mathbb E_{y \\sim \\pi(\\cdot)}\\left[\\frac1T \\sum_{t = 1}^{T} \\sum_{i\\in [N]}r_i(s_i^t, y_i^t)\\right],\\quad \\text{s.t. }\\frac1T\\mathbb E[\\sum_{i, t}y_i^t]\\le B $$\ncalculating Whittle index For the preceding RMAB problem instance, the optimal policy is an index policy––the optimal decision only needs to consider each volunteer individually (see here for the theoretical analysis).\nConsider typical volunteer $i$, alone. Assume now there is a subsidy of passivity $\\lambda$ for not incentivizing her. Denote $\\gamma_i(\\lambda)$ as the optimal average reward under this subsidy $\\lambda$​. We can write out the Bellman optimality equations: $$ \\begin{align} \\gamma_i(\\lambda) + V^k_i(1) \u0026 = \\max\\left(V^k_i(1; y = 1), V^k_i(1; y = 0)\\right)\\cr \\gamma_i(\\lambda) + V_i(0) \u0026 = \\lambda + q_i\\mathbb E_\\kappa[ V_i^\\kappa(1)] + (1 - q_i)V_i(0)\\cr \\text{where }V^k_i(1; y = 1) \u0026 = p_{k, i}(w_k + V_i(0)) + (1 - p_{k, i})\\mathbb E_\\kappa[ V_i^\\kappa(1)] \\cr V^k_i(1; y = 0) \u0026 = \\lambda + \\mathbb E_\\kappa[ V_i^\\kappa(1)] \\end{align} $$ where, $V_i^k(s_i^t)$ is the optimal reward function at state $s_i^t$ under task type $k$. Notice that, for $s_i^t = 0$ (when the volunteer is inactive), the optimal policy is to not pulling the arm and just receives subsidy $\\lambda$. And type of task $k$ doesn’t matter as well, so we drop superscript $k$ anyway.\nThe above system of equations solve $$ V_i(0) = \\mathbb E_\\kappa[ V_i^\\kappa(1)] + \\frac{\\lambda - \\gamma_i(\\lambda)}{q_i} $$ and, $$ \\gamma_i(\\lambda) + V_i^k(1) =\\mathbb E_\\kappa[ V_i^\\kappa(1)] + \\max\\left(\\frac{p_{k, i}(\\lambda - \\gamma_i(\\lambda))}{q_i} + p_{k, i}w_k, \\lambda\\right). $$ Taking expectation again for $k$: $$ \\gamma_i(\\lambda) = \\mathbb E_k \\max\\left(\\frac{p_{k, i}(\\lambda - \\gamma_i(\\lambda))}{q_i} + p_{k, i}w_k, \\lambda\\right). $$ The above one-dimensional fixed point can be pretty much solved efficiently, as does the rest of $V_i^k(1), \\forall k\\in [K]$. Let $$ \\lambda_i^\\star(k) :=\\sup_{\\lambda} \\left(\\lambda: (\\frac{p_{k, i}}{q_i}- 1)\\lambda + p_{k, i}w_k - \\frac{p_{k, i}}{q_i}\\gamma_i(\\lambda)\\ge 0\\right) $$ and it is the index for volunteer $i$ with task $k$. With the Whittle Index in our hands, we can then apply heuristics as we wishes.\n",
  "wordCount" : "551",
  "inLanguage": "en",
  "datePublished": "2024-06-07T12:29:06+08:00",
  "dateModified": "2024-06-07T12:29:06+08:00",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "//localhost:1313/posts/whittle_index_technical_1/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "ariana's blog",
    "logo": {
      "@type": "ImageObject",
      "url": "//localhost:1313/favicon.ico"
    }
  }
}
</script>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Product+Sans:wght@400;700&display=swap" rel="stylesheet">
    
    <link rel="stylesheet" href="//localhost:1313/css/custom.b017fc6c61ff4eacd2943e3c9726e1a935c706d1ea1a1b7c17773e63b47342d3.css">
    
<script async src="https://www.googletagmanager.com/gtag/js?id=AW-16651897053">
</script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'AW-16651897053');
</script>

<script>
  gtag('event', 'conversion', {
      'send_to': 'AW-16651897053/wjItCK3FisUZEN2Rn4Q-',
      'value': 1.0,
      'currency': 'USD'
  });
</script>


<script async src="https://www.googletagmanager.com/gtag/js?id=AW-16651897053"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'AW-16651897053');
</script>

</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="//localhost:1313/" accesskey="h" title="ariana&#39;s blog (Alt + H)">ariana&#39;s blog</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
                <ul class="lang-switch"><li>|</li>
                </ul>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="//localhost:1313/search" title="search (Alt &#43; /)" accesskey=/>
                    <span>search</span>
                </a>
            </li>
            <li>
                <a href="//localhost:1313/archives" title="archive">
                    <span>archive</span>
                </a>
            </li>
            <li>
                <a href="//localhost:1313/posts/tags" title="tags">
                    <span>tags</span>
                </a>
            </li>
            <li>
                <a href="//localhost:1313/posts/pinned" title="about me">
                    <span>about me</span>
                </a>
            </li>
            <li>
                <a href="//localhost:1313/procrastination_bulletin" title="pending ideas">
                    <span>pending ideas</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    
    <h1 class="post-title">
      Whittle index | an example
    </h1>
    <div class="post-meta">&lt;span title=&#39;2024-06-07 12:29:06 &#43;0800 &#43;0800&#39;&gt;June 7, 2024&lt;/span&gt;

</div>
  </header>
  <div class="post-content"><p>Consider the following RMAB problem instance. (For a review of what is an RMAB, check out <a href="/posts/whittle_index/">here</a>). A platform coordinates a total of $N$ volunteers for various tasks.</p>
<p>At each time point, a task $k$ out of $K$ possible tasks arrives randomly with probability $f_k$, and the platform must decide whom to notify (activate) based on the likelihood of acceptance $p_{k, i}, i\in [N]$ and the potential reward for each volunteer incentivized, exogeneously given as $w_k$.</p>
<p>Each volunteer can either be active or inactive at a certain time point. Only active volunteers can generate reward when incentivized (aka there&rsquo;s no use in incentivizing an inactive volunteer). Once an active volunteer produces, she instantly becomes inactive and recovers to activity based on specific probabilities $q_i$. As shown in the following diagram:</p>
<figure class="align-center ">
    <img loading="lazy" src="/who_do_we_blame/volunteer_transition.jpeg#center"
         alt="the state transitions of volunteers based on actions and associated probabilities. Active volunteers ($s_t = 1$), when no action is taken ($y_t = 0$) remains active. If action is taken ($y_t = 1$), they might generate a reward w.p. $p_i$ and become inactive, or stay active without generating a reward. Inactive volunteer return to activity based on specific probabilities ($q_i$)."/> <figcaption>
            <p>the state transitions of volunteers based on actions and associated probabilities. Active volunteers ($s_t = 1$), when no action is taken ($y_t = 0$) remains active. If action is taken ($y_t = 1$), they might generate a reward w.p. $p_i$ and become inactive, or stay active without generating a reward. Inactive volunteer return to activity based on specific probabilities ($q_i$).</p>
        </figcaption>
</figure>

<p>The decision maker (in the perspective of the platform) has action space $\mathbf y^t$, where each $y_i^t\in {0, 1}, \forall i$ corresponds to whether arm $i$ is being &lsquo;pulled&rsquo; at time step $t$. The platform aims to maximizes averaged reward over the long run:
$$
\max_\pi \lim_{T\to\infty}\mathbb E_{y \sim \pi(\cdot)}\left[\frac1T \sum_{t = 1}^{T} \sum_{i\in [N]}r_i(s_i^t, y_i^t)\right],\quad \text{s.t. }\frac1T\mathbb E[\sum_{i, t}y_i^t]\le B
$$</p>
<h2 id="calculating-whittle-index">calculating Whittle index<a hidden class="anchor" aria-hidden="true" href="#calculating-whittle-index">#</a></h2>
<p>For the preceding RMAB problem instance, the optimal policy is an index policy––the optimal decision only needs to consider each volunteer individually (see <a href="/posts/whittle_index_technical">here</a> for the theoretical analysis).</p>
<p>Consider typical volunteer $i$, alone. Assume now there is a <strong><em>subsidy of passivity</em> $\lambda$</strong> for <strong>not incentivizing her</strong>. Denote $\gamma_i(\lambda)$ as the optimal average reward under this subsidy $\lambda$​. We can write out the Bellman optimality equations:
$$
\begin{align}
\gamma_i(\lambda) + V^k_i(1) &amp; =  \max\left(V^k_i(1; y = 1), V^k_i(1; y = 0)\right)\cr
\gamma_i(\lambda) + V_i(0) &amp; = \lambda + q_i\mathbb E_\kappa[ V_i^\kappa(1)] + (1 - q_i)V_i(0)\cr
\text{where }V^k_i(1; y = 1) &amp; = p_{k, i}(w_k + V_i(0)) + (1 - p_{k, i})\mathbb E_\kappa[ V_i^\kappa(1)]
\cr
V^k_i(1; y = 0) &amp; = \lambda + \mathbb E_\kappa[ V_i^\kappa(1)]
\end{align}
$$
where, $V_i^k(s_i^t)$ is the optimal reward function at state $s_i^t$ under task type $k$. Notice that, for $s_i^t = 0$ (when the volunteer is inactive), the optimal policy is to not pulling the arm and just receives subsidy $\lambda$. And type of task $k$ doesn&rsquo;t matter as well, so we drop superscript $k$ anyway.</p>
<p>The above system of equations solve
$$
V_i(0) = \mathbb E_\kappa[ V_i^\kappa(1)] + \frac{\lambda - \gamma_i(\lambda)}{q_i}
$$
and,
$$
\gamma_i(\lambda) + V_i^k(1) =\mathbb E_\kappa[ V_i^\kappa(1)] + \max\left(\frac{p_{k, i}(\lambda - \gamma_i(\lambda))}{q_i} + p_{k, i}w_k, \lambda\right).
$$
Taking expectation again for $k$:
$$
\gamma_i(\lambda) = \mathbb E_k \max\left(\frac{p_{k, i}(\lambda - \gamma_i(\lambda))}{q_i} + p_{k, i}w_k, \lambda\right).
$$
The above one-dimensional fixed point can be pretty much solved efficiently, as does the rest of $V_i^k(1), \forall k\in [K]$. Let
$$
\lambda_i^\star(k) :=\sup_{\lambda} \left(\lambda: (\frac{p_{k, i}}{q_i}- 1)\lambda + p_{k, i}w_k - \frac{p_{k, i}}{q_i}\gamma_i(\lambda)\ge 0\right)
$$
and it is the index for volunteer $i$ with task $k$. With the Whittle Index in our hands, we can then apply heuristics as we wishes.</p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
    </ul>
  </footer>
</article>
    </main>
    
<footer class="footer">
    <span>&copy; 2025 <a href="//localhost:1313/">ariana&#39;s blog</a></span>
    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script id="usercentrics-cmp" src="https://web.cmp.usercentrics.eu/ui/loader.js" data-settings-id="_KlbvhaKistzRA" async></script>

</body>

</html>
